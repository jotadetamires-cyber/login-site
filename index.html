<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Produto</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 20px auto; }
        form { display: flex; flex-direction: column; gap: 10px; }
        input { padding: 8px; font-size: 1rem; }
        button { padding: 12px; font-size: 1rem; background-color: #28a745; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #218838; }
        #status { margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>Cadastro de Produto</h1>
    <form id="productForm">
        <label for="codigo">Código:</label>
        <input type="text" id="codigo" name="Código" required>

        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="Nome">

        <label for="categoria">Categoria:</label>
        <input type="text" id="categoria" name="Categoria">

        <label for="preco">Preço:</label>
        <input type="number" step="0.01" id="preco" name="Preço">

        <label for="quantidade">Quantidade:</label>
        <input type="number" id="quantidade" name="Quantidade">

        <button type="submit" id="submit-button">Salvar</button>
    </form>
    
    <div id="status"></div>

    <script>
        // ######################################################################
        // ## COLE A URL DO SEU SCRIPT PUBLICADO AQUI DENTRO DAS ASPAS      ##
        // ######################################################################
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby7DIcx1O1CXQU414cBEGDgAPrK8R4toKkzP208O94XP2-aI7VXbY9UYR3GEGrRj9Q/exec"; 

        const form = document.getElementById('productForm');
        const statusDiv = document.getElementById('status');
        const submitButton = document.getElementById('submit-button');
        
        // Esta parte do código lê os dados da URL quando a página carrega
        // Exatamente como na sua imagem de exemplo!
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Preenche os campos do formulário com os dados da URL
            document.getElementById('codigo').value = urlParams.get('codigo') || '';
            document.getElementById('nome').value = urlParams.get('nome') || '';
            document.getElementById('categoria').value = urlParams.get('categoria') || '';
            document.getElementById('preco').value = urlParams.get('preco') || '';
            document.getElementById('quantidade').value = urlParams.get('quantidade') || '';
        });

        // Esta parte envia os dados para a planilha quando o formulário é submetido
        form.addEventListener('submit', e => {
            e.preventDefault(); // Impede o recarregamento da página

            submitButton.disabled = true;
            statusDiv.textContent = 'Enviando, por favor aguarde...';

            const formData = new FormData(form);
            const data = {};
            // Converte os dados do formulário para um objeto simples
            formData.forEach((value, key) => (data[key] = value));

            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(result => {
                statusDiv.textContent = result.message;
                if(result.status === 'success') {
                    statusDiv.style.color = 'green';
                    form.reset(); // Limpa o formulário após o sucesso
                } else {
                    statusDiv.style.color = 'red';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                statusDiv.textContent = 'Ocorreu um erro grave. Verifique o console (F12).';
                statusDiv.style.color = 'red';
            })
            .finally(() => {
                submitButton.disabled = false; // Reativa o botão
            });
        });
    </script>
</body>
</html>
